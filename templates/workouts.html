{% extends "base.html" %}

{% block extra_css %}
<style>
/* Base container adjustments */
.container {
    max-width: 1400px;
    padding: 1rem;
}

/* Header section styling */
.header-section {
    background: #f8f9fa;
    padding: 1rem 0;
    margin-bottom: 1rem;
    width: 100%;
}

.brand-heading {
    font-size: 3rem;
    font-weight: 700;
    color: #212529;
    margin-bottom: 0.5rem;
    letter-spacing: 0.02em;
}

.subheading {
    font-size: 0.875rem;
    color: #212529;
    text-transform: uppercase;
    letter-spacing: 0.2em;
    margin-bottom: 1.5rem;
    font-weight: 400;
}

.track-badge {
    display: inline-block;
    background: #212529;
    color: #fff;
    padding: 0.4rem 1.2rem;
    border-radius: 50px;
    font-size: 0.75rem;
    font-weight: 500;
    letter-spacing: 0.1em;
}

.pulse-badge {
    animation: pulse 2s infinite;
}

@keyframes pulse {
    0% {
        box-shadow: 0 0 0 0 rgba(52, 152, 219, 0.4);
    }
    70% {
        box-shadow: 0 0 0 10px rgba(52, 152, 219, 0);
    }
    100% {
        box-shadow: 0 0 0 0 rgba(52, 152, 219, 0);
    }
}

/* Workout cards improvements */
.workout-card {
    background: rgba(255, 255, 255, 0.95);
    border-radius: 15px;
    padding: 2rem;
    margin-bottom: 2rem;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    color: #2c3e50;
    font-size: 1.1rem;
    line-height: 1.6;
    height: 100%;
    display: flex;
    flex-direction: column;
}

.workout-card h3 {
    color: #2c3e50;
    font-size: 1.8rem;
    margin-bottom: 1rem;
    font-weight: 600;
}

.workout-card .intensity-badge {
    display: inline-block;
    background: #3498db;
    color: white;
    padding: 0.5rem 1rem;
    border-radius: 20px;
    font-size: 0.9rem;
    font-weight: 500;
    margin-bottom: 1rem;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.workout-card pre {
    background: rgba(44, 62, 80, 0.05);
    padding: 1.5rem;
    border-radius: 10px;
    margin: 1rem 0;
    white-space: pre-wrap;
    font-family: 'Courier New', monospace;
    font-size: 1rem;
    color: #2c3e50;
    border: 1px solid rgba(52, 152, 219, 0.2);
}

.workout-card .science {
    font-style: italic;
    color: #7f8c8d;
    margin-top: 1rem;
    padding-top: 1rem;
    border-top: 1px solid rgba(52, 152, 219, 0.2);
}

.workout-card .meta {
    margin-top: 1.5rem;
    padding-top: 1.5rem;
    border-top: 1px solid rgba(52, 152, 219, 0.2);
    font-size: 0.9rem;
    color: #95a5a6;
}

.workout-card .meta span {
    display: inline-block;
    margin-right: 1.5rem;
}

.workout-card .meta i {
    margin-right: 0.5rem;
    color: #3498db;
}

.workout-type {
    display: inline-block;
    padding: 0.4rem 1rem;
    background: #f8f9fa;
    border: 1px solid #e9ecef;
    border-radius: 6px;
    color: #212529;
    font-size: 0.8rem;
    letter-spacing: 0.1em;
    margin-bottom: 1.25rem;
    font-weight: 600;
    text-transform: uppercase;
}

.workout-title {
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 1rem;
    color: #212529;
    letter-spacing: -0.01em;
}

.workout-description {
    color: #212529;
    font-size: 1rem;
    margin-bottom: 1.25rem;
    line-height: 1.6;
}

.workout-list {
    list-style: none;
    padding: 0;
    margin: 0 0 1.5rem 0;
    flex-grow: 1;
}

.workout-list li {
    color: #212529;
    font-size: 0.95rem;
    margin-bottom: 0.875rem;
    padding-left: 1.25rem;
    position: relative;
    line-height: 1.5;
}

.workout-list li::before {
    content: "→";
    position: absolute;
    left: 0;
    color: #495057;
    font-weight: bold;
}

.workout-footer {
    color: #495057;
    font-size: 0.9rem;
    font-style: italic;
    margin-top: auto;
    border-top: 1px solid #f1f3f5;
    padding-top: 1rem;
}

/* Form improvements */
.quantum-border {
    background: rgba(10, 15, 25, 0.95);
    padding: 2.5rem;
    border-radius: 16px;
    border: 1px solid rgba(135, 206, 250, 0.3);
    position: relative;
    overflow: hidden;
    margin-bottom: 3rem;
    box-shadow: 0 0 30px rgba(0, 150, 255, 0.1);
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
    color: white;
}

.quantum-border::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(135, 206, 250, 0.5), transparent);
}

.question-container {
    max-width: 800px;
    margin: 0 auto;
    padding: 2rem;
    background: linear-gradient(145deg, rgba(255, 255, 255, 0.98), rgba(248, 249, 250, 0.98));
    border-radius: 20px;
    box-shadow: 0 8px 32px rgba(31, 38, 135, 0.12);
    transition: transform 0.3s ease;
}

.question-container:hover {
    transform: translateY(-2px);
}

.question-section {
    display: none;
    opacity: 0;
    transition: opacity 0.3s ease-in-out;
}

.question-section.active {
    display: block;
    opacity: 1;
}

.question-section h4 {
    color: #2c3e50;
    font-size: 1.5rem;
    margin-bottom: 2rem;
    font-weight: 600;
    background: linear-gradient(90deg, #2c3e50, #3498db);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
}

.form-label {
    color: #34495e;
    font-weight: 500;
    font-size: 1.1rem;
    margin-bottom: 1rem;
    letter-spacing: 0.02em;
}

.form-control {
    padding: 1rem 1.25rem;
    font-size: 1.1rem;
    border: 2px solid rgba(52, 152, 219, 0.15);
    border-radius: 12px;
    transition: all 0.3s ease;
    background: rgba(255, 255, 255, 0.8);
}

.form-control:focus {
    border-color: #3498db;
    box-shadow: 0 0 0 4px rgba(52, 152, 219, 0.1);
    background: rgba(255, 255, 255, 0.95);
}

.form-control:hover {
    border-color: rgba(52, 152, 219, 0.3);
}

.btn-primary {
    background: linear-gradient(135deg, #3498db, #2980b9);
    border: none;
    color: #ffffff;
    font-weight: 500;
    padding: 1rem 2rem;
    border-radius: 12px;
    transition: all 0.3s ease;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    font-size: 0.95rem;
}

.btn-primary:hover {
    background: linear-gradient(135deg, #2980b9, #2573a7);
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(41, 128, 185, 0.2);
}

.btn-secondary {
    background: linear-gradient(135deg, #f8f9fa, #e9ecef);
    border: none;
    color: #495057;
    font-weight: 500;
    padding: 1rem 2rem;
    border-radius: 12px;
    transition: all 0.3s ease;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    font-size: 0.95rem;
}

.btn-secondary:hover {
    background: linear-gradient(135deg, #e9ecef, #dee2e6);
    color: #212529;
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
}

.text-muted {
    color: #6c757d !important;
    font-size: 1.1rem;
    letter-spacing: 0.02em;
    margin-bottom: 2rem;
}

.loading-animation {
    max-width: 600px;
    margin: 0 auto;
    padding: 2rem;
    text-align: center;
    background: #ffffff;
    border: 1px solid #dee2e6;
    border-radius: 12px;
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
}

.calculating {
    color: #3498db;
    font-weight: 600;
    font-size: 1.2rem;
}

.progress {
    height: 8px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 4px;
    overflow: hidden;
}

.progress-bar {
    background-color: #3498db;
}

#result {
    max-width: 800px;
    margin: 0 auto;
}

.hover-lift {
    transition: transform 0.2s ease;
}

.hover-lift:hover {
    transform: translateY(-2px);
}

/* System intro improvements */
.system-intro {
    max-width: 800px;
    margin: 0 auto 4rem auto;
    text-align: center;
}

.system-intro h2 {
    font-size: 2.5rem;
    font-weight: 600;
    margin-bottom: 1.5rem;
    color: #FFFFFF;
    letter-spacing: 0.05em;
}

.system-intro p {
    font-size: 1.1rem;
    line-height: 1.6;
    color: #7EB3FF;
    font-weight: 400;
    letter-spacing: 0.02em;
}

/* Video link improvements */
.watch-video {
    color: #495057;
    text-decoration: none;
    font-size: 0.85rem;
    font-weight: 500;
}

.watch-video:hover {
    color: #212529;
    text-decoration: underline;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .container {
        padding: 1.5rem;
    }
    
    .brand-heading {
        font-size: 4rem;
    }
    
    .workout-card {
        padding: 2rem;
    }
    
    .quantum-border {
        padding: 2.5rem;
    }
    
    .system-intro h2 {
        font-size: 2.5rem;
    }
}

@media (max-width: 576px) {
    .brand-heading {
        font-size: 3rem;
    }
    
    .btn {
        padding: 0.9rem 2rem;
        font-size: 0.9rem;
    }
}

/* Add spacing between rows */
.row {
    margin-bottom: -2rem;
}

/* Container spacing fix */
.container {
    max-width: 1400px;
    padding: 1rem;
}

.row > [class*='col-'] {
    margin-bottom: 2.5rem;
}

.mt-5 {
    margin-top: 1rem !important;
}

/* 320AI Tool Section */
.tool-section {
    background: linear-gradient(to right, #f8f9fa, #ffffff);
    border: 1px solid #dee2e6;
    border-radius: 12px;
    padding: 2.5rem;
    margin-bottom: 3rem;
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.03);
}

.tool-heading {
    color: #212529;
    font-size: 1.75rem;
    font-weight: 600;
    margin-bottom: 1rem;
    text-align: center;
}

.tool-description {
    color: #495057;
    font-size: 1rem;
    line-height: 1.6;
    margin-bottom: 2rem;
    text-align: center;
    max-width: 700px;
    margin-left: auto;
    margin-right: auto;
}

.question-step {
    display: none;
}

.question-step.active {
    display: block;
}

.question-label {
    color: #212529;
    font-size: 1.1rem;
    font-weight: 500;
    margin-bottom: 1rem;
}

.btn-container {
    display: flex;
    justify-content: space-between;
    margin-top: 1.5rem;
}

.btn-back {
    background: #e9ecef;
    color: #495057;
}

.btn-back:hover {
    background: #dee2e6;
}

/* Button improvements */
.btn-primary {
    background-color: #3498db;
    border-color: #3498db;
    color: #ffffff;
    font-weight: 500;
    padding: 0.75rem 1.5rem;
}

.btn-primary:hover {
    background-color: #2980b9;
    border-color: #2980b9;
    transform: translateY(-2px);
}

.btn-secondary {
    background-color: #e9ecef;
    border-color: #e9ecef;
    color: #495057;
    font-weight: 500;
    padding: 0.75rem 1.5rem;
}

.btn-secondary:hover {
    background-color: #dee2e6;
    border-color: #dee2e6;
    color: #212529;
}

#calculationStatus {
    color: #495057;
    font-size: 1rem;
    margin-top: 1rem;
}

.ai-feature-section {
    text-align: center;
    padding: 4rem 0;
    background: linear-gradient(135deg, rgba(20, 30, 48, 0.92), rgba(36, 59, 85, 0.92));
    border-radius: 16px;
    margin-bottom: 3rem;
}

.ai-feature-heading {
    font-size: 2.8rem;
    font-weight: 600;
    background: linear-gradient(to right, #fff, #a0d8ef);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    margin-bottom: 1.5rem;
}

.ai-feature-subheading {
    font-size: 1.2rem;
    color: rgba(255, 255, 255, 0.9);
    max-width: 800px;
    margin: 0 auto 2rem;
    line-height: 1.6;
}

.feature-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 2rem;
    margin: 3rem 0;
    padding: 0 2rem;
}

.feature-item {
    text-align: center;
    padding: 1.5rem;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.feature-item i {
    font-size: 2rem;
    color: #3498db;
    margin-bottom: 1rem;
}

.feature-item h3 {
    color: #fff;
    font-size: 1.2rem;
    margin-bottom: 0.5rem;
}

.feature-item p {
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.9rem;
    line-height: 1.5;
}

.question-container {
    max-width: 800px;
    margin: 0 auto;
    padding: 1.5rem;
    background: rgba(255, 255, 255, 0.98);
    border-radius: 16px;
    box-shadow: 0 8px 32px rgba(31, 38, 135, 0.15);
}

.question-section h4 {
    color: #2c3e50;
    font-size: 1.4rem;
    margin-bottom: 1.5rem;
    font-weight: 600;
}

.form-label {
    color: #34495e;
    font-weight: 500;
    font-size: 1.1rem;
    margin-bottom: 0.75rem;
}

.form-control {
    padding: 1rem;
    font-size: 1.1rem;
    border: 2px solid #eee;
    border-radius: 8px;
    transition: all 0.3s ease;
}

.form-control:focus {
    border-color: #3498db;
    box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
}

.quantum-processing {
    padding: 3rem;
    background: rgba(255, 255, 255, 0.98);
    border-radius: 16px;
    box-shadow: 0 8px 32px rgba(31, 38, 135, 0.15);
    text-align: center;
}

.processing-animation {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 1rem;
    margin: 2rem 0;
}

.quantum-circle {
    width: 20px;
    height: 20px;
    background: #3498db;
    border-radius: 50%;
    animation: quantum-pulse 1.5s infinite ease-in-out;
}

.quantum-circle:nth-child(2) {
    animation-delay: 0.2s;
}

.quantum-circle:nth-child(3) {
    animation-delay: 0.4s;
}

@keyframes quantum-pulse {
    0% { transform: scale(0.8); opacity: 0.5; }
    50% { transform: scale(1.2); opacity: 1; }
    100% { transform: scale(0.8); opacity: 0.5; }
}

.calculating {
    color: #2c3e50;
    font-size: 1.4rem;
    font-weight: 600;
}

.status-message {
    color: #34495e;
    font-size: 1.1rem;
    font-weight: 500;
    min-height: 1.5em;
}

.pulse-badge {
    display: inline-block;
    padding: 0.5rem 1.5rem;
    background: linear-gradient(45deg, #3498db, #2980b9);
    color: white;
    border-radius: 25px;
    font-weight: 600;
    letter-spacing: 1px;
    animation: badge-pulse 2s infinite;
}

@keyframes badge-pulse {
    0% { box-shadow: 0 0 0 0 rgba(52, 152, 219, 0.4); }
    70% { box-shadow: 0 0 0 10px rgba(52, 152, 219, 0); }
    100% { box-shadow: 0 0 0 0 rgba(52, 152, 219, 0); }
}
</style>
{% endblock %}

{% block content %}
<section class="header-section">
    <div class="container">
        <div class="row">
            <div class="col-12 text-center">
                <h1 class="brand-heading">320 DAY</h1>
                <p class="subheading">Don't wing it. Wingate it.</p>
                <div class="track-badge">A DAISY™ x 320TC Collaboration</div>
            </div>
        </div>
    </div>
</section>

<div class="container mt-5">
    <div id="questionnaireForm">
        <div class="question-container">
            <div class="text-center mb-4">
                <h2 class="mt-3" style="color: #2c3e50;">Find Your Kick</h2>
                <p class="text-muted">Refine data to receive <strong>DAISY™</strong> optimized workout</p>
            </div>
            
            <!-- Question 1 -->
            <div class="question-section active" id="q1">
                <div class="mb-4">
                    <input type="text" class="form-control" id="userName" placeholder="Enter your name" required>
                </div>
                <button class="btn btn-primary btn-lg w-100" onclick="nextQuestion(1)">Begin Analysis</button>
            </div>

            <!-- Question 2 -->
            <div class="question-section" id="q2">
                <div class="progress mb-4" style="height: 6px; background: rgba(52, 152, 219, 0.1);">
                    <div class="progress-bar" role="progressbar" style="width: 22%; background: linear-gradient(90deg, #3498db, #2980b9);" aria-valuenow="22" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
                <div class="mb-3">
                    <label class="form-label">Kilometers run in past 320 days?</label>
                    <input type="number" class="form-control" id="miles_past_320_days">
                </div>
                <button class="btn btn-secondary" onclick="prevQuestion(2)">Back</button>
                <button class="btn btn-primary hover-lift" onclick="nextQuestion(2)">Next</button>
            </div>

            <!-- Question 3 -->
            <div class="question-section" id="q3">
                <div class="progress mb-4" style="height: 6px; background: rgba(52, 152, 219, 0.1);">
                    <div class="progress-bar" role="progressbar" style="width: 33%; background: linear-gradient(90deg, #3498db, #2980b9);" aria-valuenow="33" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
                <div class="mb-3">
                    <label class="form-label">Furlongs planned for 2025?</label>
                    <input type="number" class="form-control" id="kilometers_2025">
                </div>
                <button class="btn btn-secondary" onclick="prevQuestion(3)">Back</button>
                <button class="btn btn-primary hover-lift" onclick="nextQuestion(3)">Next</button>
            </div>

            <!-- Question 4 -->
            <div class="question-section" id="q4">
                <div class="progress mb-4" style="height: 6px; background: rgba(52, 152, 219, 0.1);">
                    <div class="progress-bar" role="progressbar" style="width: 44%; background: linear-gradient(90deg, #3498db, #2980b9);" aria-valuenow="44" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
                <div class="mb-3">
                    <label class="form-label">Average heart rate while walking?</label>
                    <input type="number" class="form-control" id="avg_hr_walking">
                </div>
                <button class="btn btn-secondary" onclick="prevQuestion(4)">Back</button>
                <button class="btn btn-primary hover-lift" onclick="nextQuestion(4)">Next</button>
            </div>

            <!-- Question 5 -->
            <div class="question-section" id="q5">
                <div class="progress mb-4" style="height: 6px; background: rgba(52, 152, 219, 0.1);">
                    <div class="progress-bar" role="progressbar" style="width: 55%; background: linear-gradient(90deg, #3498db, #2980b9);" aria-valuenow="55" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
                <div class="mb-3">
                    <label class="form-label">Days since last haircut?</label>
                    <input type="number" class="form-control" id="recent_haircut">
                </div>
                <button class="btn btn-secondary" onclick="prevQuestion(5)">Back</button>
                <button class="btn btn-primary hover-lift" onclick="nextQuestion(5)">Next</button>
            </div>

            <!-- Question 6 -->
            <div class="question-section" id="q6">
                <div class="progress mb-4" style="height: 6px; background: rgba(52, 152, 219, 0.1);">
                    <div class="progress-bar" role="progressbar" style="width: 66%; background: linear-gradient(90deg, #3498db, #2980b9);" aria-valuenow="66" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
                <div class="mb-3">
                    <label class="form-label">Iron levels?</label>
                    <input type="number" class="form-control" id="iron_levels">
                </div>
                <button class="btn btn-secondary" onclick="prevQuestion(6)">Back</button>
                <button class="btn btn-primary hover-lift" onclick="nextQuestion(6)">Next</button>
            </div>

            <!-- Question 7 -->
            <div class="question-section" id="q7">
                <div class="progress mb-4" style="height: 6px; background: rgba(52, 152, 219, 0.1);">
                    <div class="progress-bar" role="progressbar" style="width: 77%; background: linear-gradient(90deg, #3498db, #2980b9);" aria-valuenow="77" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
                <div class="mb-3">
                    <label class="form-label">Date of your last race?</label>
                    <input type="date" class="form-control" id="last_race_date">
                </div>
                <button class="btn btn-secondary" onclick="prevQuestion(7)">Back</button>
                <button class="btn btn-primary hover-lift" onclick="nextQuestion(7)">Next</button>
            </div>

            <!-- Question 8 -->
            <div class="question-section" id="q8">
                <div class="progress mb-4" style="height: 6px; background: rgba(52, 152, 219, 0.1);">
                    <div class="progress-bar" role="progressbar" style="width: 88%; background: linear-gradient(90deg, #3498db, #2980b9);" aria-valuenow="88" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
                <div class="mb-3">
                    <label class="form-label">Race of your last date?</label>
                    <input type="text" class="form-control" id="last_date_race">
                </div>
                <button class="btn btn-secondary" onclick="prevQuestion(8)">Back</button>
                <button class="btn btn-primary hover-lift" onclick="nextQuestion(8)">Next</button>
            </div>

            <!-- Question 9 -->
            <div class="question-section" id="q9">
                <div class="progress mb-4" style="height: 6px; background: rgba(52, 152, 219, 0.1);">
                    <div class="progress-bar" role="progressbar" style="width: 100%; background: linear-gradient(90deg, #3498db, #2980b9);" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
                <div class="mb-3">
                    <label class="form-label">Projected Wingos in 2025</label>
                    <input type="number" class="form-control" id="ssn_digit_sum">
                </div>
                <button class="btn btn-secondary" onclick="prevQuestion(9)">Back</button>
                <button class="btn btn-primary hover-lift" onclick="submitForm()">Giddy Up</button>
            </div>

            <!-- Move learn more link to bottom and make it more subtle -->
            <div class="text-center mt-3">
                <a href="{{ url_for('daisy') }}" class="btn btn-link text-muted small" style="text-decoration: none; font-size: 0.85rem; opacity: 0.8;">
                    WTF is DAISY™? <i class="fas fa-chevron-right ms-1" style="font-size: 0.7rem;"></i>
                </a>
                <a href="{{ url_for('wingo_converter') }}" class="btn btn-link text-muted small" style="text-decoration: none; font-size: 0.85rem; opacity: 0.8;">
                    Wingo Converter <i class="fas fa-chevron-right ms-1" style="font-size: 0.7rem;"></i>
                </a>
            </div>
        </div>
    </div>

    <!-- Loading Animation -->
    <div id="loadingSection" class="loading-animation" style="display: none;">
        <div class="quantum-processing">
            <div class="track-badge pulse-badge mb-4">QUANTUM PROCESSING</div>
            <div class="processing-animation">
                <div class="quantum-circle"></div>
                <div class="quantum-circle"></div>
                <div class="quantum-circle"></div>
            </div>
            <h3 class="calculating mb-4">Analyzing Training Parameters</h3>
            <div class="progress mb-4" style="height: 8px;">
                <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar"></div>
            </div>
            <div id="calculationStatus" class="status-message"></div>
        </div>
    </div>

    <!-- Results Section -->
    <div id="result" class="mt-4" style="display: none;"></div>

    <div id="homeButton" style="display: none;" class="text-center mt-4">
        <button onclick="location.reload()" class="btn btn-outline-dark hover-lift">
            ← Generate Another Workout
        </button>
    </div>
</div>

<!-- AI Info Modal -->
<div class="modal fade" id="aiInfoModal" tabindex="-1" aria-labelledby="aiInfoModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content" style="background: linear-gradient(135deg, rgba(20, 30, 48, 0.98), rgba(36, 59, 85, 0.98)); color: white;">
            <div class="modal-header border-0">
                <h5 class="modal-title" id="aiInfoModalLabel">
                    <div class="track-badge mb-2">Meet DAISY™</div>
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row g-4">
                    <div class="col-12 mb-4">
                        <p class="lead" style="color: #a0d8ef; line-height: 1.6;">
                            Hay hay hay! I'm DAISY™, your dedicated AI-powered running coach and also a horse. Whether you're galloping a 320-meter Wingo or cantering a 3,200-furlong adventure to Yellowstone, I'll be here to guide you through the quantum realm of individualized efficiency—where unpredictability becomes a calculated advantage, adaptation transcends conventional wisdom, and the very essence of training is redefined through the lens of equine-inspired optimization.
                        </p>
                    </div>
                    <div class="col-md-6">
                        <div class="p-3 rounded" style="background: rgba(255, 255, 255, 0.05);">
                            <i class="fas fa-horse mb-3" style="font-size: 2rem; color: #3498db;"></i>
                            <h4 class="h5 mb-2">Coach DAISY™</h4>
                            <p class="small text-white-50">Personalized training and life advice from your 140-year-old equine running coach.</p>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="p-3 rounded" style="background: rgba(255, 255, 255, 0.05);">
                            <i class="fas fa-chart-line mb-3" style="font-size: 2rem; color: #3498db;"></i>
                            <h4 class="h5 mb-2">DAISY™ Score</h4>
                            <p class="small text-white-50">Measure your harmonic efficiency with the natural rhythms of running.</p>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="p-3 rounded" style="background: rgba(255, 255, 255, 0.05);">
                            <i class="fas fa-microchip mb-3" style="font-size: 2rem; color: #3498db;"></i>
                            <h4 class="h5 mb-2">Workout Optimizer</h4>
                            <p class="small text-white-50">Refine running macrodata to receive DAISY™ designed workouts.</p>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="p-3 rounded" style="background: rgba(255, 255, 255, 0.05);">
                            <i class="fas fa-map-marked-alt mb-3" style="font-size: 2rem; color: #3498db;"></i>
                            <h4 class="h5 mb-2">Yellowstone</h4>
                            <p class="small text-white-50">Relive Daisy and George's legendary 1885 journey in our interactive game.</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer border-0">
                <button type="button" class="btn btn-outline-light" data-bs-dismiss="modal">Experience DAISY™</button>
            </div>
        </div>
    </div>
</div>

<!-- Add section header for workout boxes -->
<div class="container mt-5">
    <div class="text-center mb-5">
        <h2 style="color: #2c3e50; font-size: 2.2rem; font-weight: 700;">The Wingate Collection</h2>
        <p class="text-muted" style="max-width: 600px; margin: 1rem auto;">DAISY™ Developed. 320 Approved.</p>
    </div>

    <!-- Workout Cards -->
    <div class="row">
        <!-- The Yellowstone -->
        <div class="col-md-6 col-lg-4">
            <div class="workout-card">
                <span class="workout-type">ENDURANCE</span>
                <h3 class="workout-title">The Yellowstone</h3>
                <p class="workout-description">Simple but brutal:</p>
                <ul class="workout-list">
                    <li>32 Wingos</li>
                    <li>That's it. That's the workout.</li>
                    <li>Keep the pace consistently inconsistent</li>
                </ul>
                <div class="workout-footer">Look out for porcupines and bikers</div>
            </div>
        </div>

        <!-- ERock's 160 -->
        <div class="col-md-6 col-lg-4">
            <div class="workout-card">
                <span class="workout-type">CLASSIC</span>
                <h3 class="workout-title">ERock's 160</h3>
                <p class="workout-description">The special:</p>
                <ul class="workout-list">
                    <li>5 Half-Wingos at threshold with workouts in between</li>
                    <li>Select 2 from: pushups, planks, wall sit, lunges, bicycle crunches, burpees, situps, jump lunges, squat lunges, squats...</li>
                    <li>Five minute rest, then repeat</li>
                </ul>
                <div class="workout-footer">Choose wisely, suffer greatly</div>
            </div>
        </div>

        <!-- Mind the Divot -->
        <div class="col-md-6 col-lg-4">
            <div class="workout-card">
                <span class="workout-type">AGILITY</span>
                <h3 class="workout-title">Mind the Divot</h3>
                <p class="workout-description">A test of agility, awareness, and hops:</p>
                <ul class="workout-list">
                    <li>Warm-up: 1-2 easy Wingos</li>
                    <li>Main Set: 6 Wingos at tempo pace</li>
                    <li>At the divot: 10 two-legged hops</li>
                </ul>
                <div class="workout-footer">Respect the ankle gods</div>
            </div>
        </div>

        <!-- THE DAISY -->
        <div class="col-md-6 col-lg-4">
            <div class="workout-card">
                <span class="workout-type">PARTNER</span>
                <h3 class="workout-title">Three-Legged Daisy</h3>
                <p class="workout-description">3 x three-legged Wingos:</p>
                <ul class="workout-list">
                    <li>First Wingo: Moderate pace, focus on coordination</li>
                    <li>Second Wingo: Modereter pace, focus on efficiency</li>
                    <li>Third Wingo, on your own</li>
                    <li>Switch inside/outside leg positions each round</li>
                    <li>Finish with victory Wingo (regular two legs)</li>
                </ul>
                <div class="workout-footer">Three legs are better than two</div>
            </div>
        </div>

        <!-- TRIMBLE -->
        <div class="col-md-6 col-lg-4">
            <div class="workout-card">
                <span class="workout-type">BUFFALO</span>
                <h3 class="workout-title">The TRIMBLE</h3>
                <p class="workout-description">A classic speed contrast workout:</p>
                <ul class="workout-list">
                    <li>10 x Wingos total</li>
                    <li>First 160m: Very Fast</li>
                    <li>Second 160m: Very Slow</li>
                </ul>
                <div class="workout-footer">The key is maximizing the contrast between fast and slow</div>
            </div>
        </div>

        <!-- The 320 -->
        <div class="col-md-6 col-lg-4">
            <div class="workout-card">
                <span class="workout-type">5 Minutes of Pain</span>
                <h3 class="workout-title">The Goran Dragic</h3>
                <p class="workout-description">Hold your horses:</p>
                <ul class="workout-list">
                    <li>320 seconds of plank</li>
                    <li>That's all</li>
                </ul>
                <div class="workout-footer">Keep ya head up</div>
            </div>
        </div>

        <!-- Song Roulette -->
        <div class="col-md-6 col-lg-4">
            <div class="workout-card">
                <span class="workout-type">Genie in a Bottle</span>
                <h3 class="workout-title">Song Roulette</h3>
                <p class="workout-description">3km of Christina-powered chaos:</p>
                <ul class="workout-list">
                    <li>Each km paced to random Christina</li>
                    <li>Hit "Fighter"? Time to sprint!</li>
                    <li>"Beautiful"? Recovery pace</li>
                </ul>
                <div class="workout-footer">What a girl wants? More Christina.</div>
            </div>
        </div>

        <!-- Reverse Running -->
        <div class="col-md-6 col-lg-4">
            <div class="workout-card">
                <span class="workout-type">Reverse</span>
                <h3 class="workout-title">Do Look Back in Anger</h3>
                <p class="workout-description">Master the art of backwards running:</p>
                <ul class="workout-list">
                    <li>8 x 80m backwards buildup</li>
                    <li>4 x Furlongs alternating (front-back)</li>
                    <li>3 x Wingos (front-back-front)</li>
                </ul>
                <div class="workout-footer">Stay out of Lane 1</div>
            </div>
        </div>

        <!-- LOST -->
        <div class="col-md-6 col-lg-4">
            <div class="workout-card">
                <span class="workout-type">Ladder</span>
                <h3 class="workout-title">Get Lost</h3>
                <p class="workout-description">We have to go back:</p>
                <ul class="workout-list">
                    <li>40m sprint</li>
                    <li>80m, 150m, 160m progression</li>
                    <li>230m, 420m buildup</li>
                    <li>Down the ladder</li>
                    <li>Do it again</li>
                </ul>
                <div class="workout-footer">Don't tell us what you can't do</div>
            </div>
        </div>

        <!-- The Clock -->
        <div class="col-md-6 col-lg-4">
            <div class="workout-card">
                <span class="workout-type">PRECISION</span>
                <h3 class="workout-title">Watch Out</h3>
                <p class="workout-description">Take off the Garmin:</p>
                <ul class="workout-list">
                    <li>Tempo for exactly 320 seconds</li>
                    <li>Must finish within 5s of 320s</li>
                    <li>Outside range? Start over!</li>
                </ul>
                <div class="workout-footer">Timing is everything</div>
            </div>
        </div>

        <!-- HangTime -->
        <div class="col-md-6 col-lg-4">
            <div class="workout-card">
                <span class="workout-type">STRENGTH</span>
                <h3 class="workout-title">The G.W. Wingate Challenge</h3>
                <p class="workout-description">Can you hang?</p>
                <ul class="workout-list">
                    <li>Hang on field goal post</li>
                    <li>Total time: 320 seconds</li>
                    <li>Add 10 seconds for every 30 seconds of rest</li>
                </ul>
                <div class="workout-footer">Grip it and trip it</div>
            </div>
        </div>

        <!-- The Stretch -->
        <div class="col-md-6 col-lg-4">
            <div class="workout-card">
                <span class="workout-type">RECOVERY</span>
                <h3 class="workout-title">Caroline in My Mind</h3>
                <p class="workout-description">Essential recovery:</p>
                <ul class="workout-list">
                    <li>10-minute stretch</li>
                    <li><a href="https://www.youtube.com/watch?v=nlitqDM40BE" target="_blank">Follow video</a> but at your own risk</li>
                    <li>Perfect for post-workout!</li>
                </ul>
                <div class="workout-footer">Stay flexible. Stay loyal.</div>
            </div>
        </div>
    </div>
</div>

{% block extra_js %}
<script>
function validateInput(questionId) {
    // Only validate question 1 (name is required)
    if (questionId === 'q1') {
        const input = document.getElementById('userName');
        return input.value.trim() !== '';
    }
    return true;
}

function nextQuestion(currentQuestionNum) {
    const currentQuestion = document.getElementById(`q${currentQuestionNum}`);
    
    // Only validate name field (q1)
    if (currentQuestionNum === 1 && !validateInput('q1')) {
        alert('Please enter your name to continue.');
        return;
    }
    
    const nextQuestionNum = currentQuestionNum + 1;
    const nextQuestion = document.getElementById(`q${nextQuestionNum}`);
    
    if (nextQuestion) {
        currentQuestion.classList.remove('active');
        nextQuestion.classList.add('active');
    }
}

function prevQuestion(currentQuestionNum) {
    const currentQuestion = document.getElementById(`q${currentQuestionNum}`);
    const prevQuestionNum = currentQuestionNum - 1;
    const prevQuestion = document.getElementById(`q${prevQuestionNum}`);
    
    if (prevQuestion) {
        currentQuestion.classList.remove('active');
        prevQuestion.classList.add('active');
    }
}

async function submitForm() {
    const formData = {
        name: document.getElementById('userName').value,
        miles_past_320_days: document.getElementById('miles_past_320_days').value,
        kilometers_2025: document.getElementById('kilometers_2025').value,
        avg_hr_walking: document.getElementById('avg_hr_walking').value,
        recent_haircut: document.getElementById('recent_haircut').value,
        iron_levels: document.getElementById('iron_levels').value,
        last_race_date: document.getElementById('last_race_date').value,
        last_date_race: document.getElementById('last_date_race').value,
        ssn_digit_sum: document.getElementById('ssn_digit_sum').value
    };

    // Hide form, show loading
    document.getElementById('questionnaireForm').style.display = 'none';
    const loadingSection = document.getElementById('loadingSection');
    loadingSection.style.display = 'block';

    // Fake loading sequence
    const progressBar = document.querySelector('.progress-bar');
    const statusDiv = document.getElementById('calculationStatus');
    const statuses = [
        "Analyzing divots...",
        "Processing DAISY™ insights...",
        "Calibrating Wingatian parameters...",
        "Measuring harmonic efficiency...",
        "Optimizing for Wingo distance...",
        "Fine-tuning furlong intensity...",
        "Preparing your custom dynamic session..."
    ];

    for (let i = 0; i < statuses.length; i++) {
        statusDiv.textContent = statuses[i];
        progressBar.style.width = `${(i + 1) * (100 / statuses.length)}%`;
        await new Promise(r => setTimeout(r, 800));
    }

    try {
        const response = await fetch('/generate_workout', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(formData)
        });
        
        const data = await response.json();

        // Hide loading, show results
        loadingSection.style.display = 'none';
        const resultDiv = document.getElementById('result');
        resultDiv.style.display = 'block';

        // Update result template
        resultDiv.innerHTML = `
            <div class="alert" style="background: rgba(0, 0, 0, 0.7); border: 1px solid rgba(52, 152, 219, 0.3); border-radius: 12px; color: white; padding: 2rem;">
                <div class="track-badge mb-3">SESSION ${Math.floor(Math.random() * 900000) + 100000}</div>
                <h4 class="alert-heading mb-4">${data.workout_intro}</h4>
                <div class="workout-text">
                    <h3 class="text-gradient mb-3" style="color: #ffffff; font-size: 2rem; letter-spacing: 0.05em; font-style: italic;">${data.workout_details.intensity}</h3>
                    <h2 style="color: white; font-size: 2.2rem; font-weight: 700; margin-bottom: 0.5rem; letter-spacing: -0.02em;">${data.workout_details.workout.split('\n')[0]}</h2>
                    ${data.workout_details.workout.split('\n').slice(1).join('<br>')}
                </div>
                <hr style="border-color: rgba(52, 152, 219, 0.3);">
                <p><em>${data.workout_details.science}</em></p>
                <p class="mb-0"><small class="text-uppercase" style="letter-spacing: 1px;">${data.ai_insight}</small></p>
                <div class="mt-3" style="color: rgba(255, 255, 255, 0.6); font-size: 0.8rem;">
                    <span class="text-uppercase">Custom Workout</span> • 
                    Validated by ${data.meta.models_consulted} track club members • 
                    Analysis time: ${data.meta.processing_time_ms}ms
                </div>
            </div>
        `;
    } catch (error) {
        console.error('Error:', error);
        alert('Error generating workout. Please try again.');
        loadingSection.style.display = 'none';
        document.getElementById('questionnaireForm').style.display = 'block';
    }

    document.getElementById('homeButton').style.display = 'block';
}
</script>
{% endblock %}

{% endblock %}
