{% extends "base.html" %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/daisy.css') }}">
<style>
:root {
    --primary-color: #3498db;
    --secondary-color: #2ecc71;
    --background-dark: #1a1a1a;
    --text-light: #ffffff;
    --text-dark: #333333;
    --shadow-color: rgba(52, 152, 219, 0.3);
    --gradient-primary: linear-gradient(45deg, #2c3e50, #3498db);
    --gradient-accent: linear-gradient(45deg, #00ff88, #00bfff);
}

/* Chat Popup Styles */
.chat-popup {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: min(400px, 90vw);
    height: min(600px, 80vh);
    background: rgba(26, 26, 26, 0.95);
    border: 2px solid var(--primary-color);
    border-radius: 16px;
    box-shadow: 0 5px 30px rgba(52, 152, 219, 0.4);
    display: none;
    z-index: 1000;
    overflow: hidden;
    backdrop-filter: blur(10px);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.chat-popup.active {
    display: block;
    animation: slideUp 0.3s ease-out;
}

@keyframes slideUp {
    from {
        transform: translateY(20px);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}

.chat-toggle {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 60px;
    height: 60px;
    background: url('/static/images/daisy_headshot.png') center/cover;
    border: 3px solid var(--secondary-color);
    border-radius: 50%;
    cursor: pointer;
    box-shadow: 0 5px 20px rgba(46, 204, 113, 0.4);
    z-index: 1001;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.chat-toggle:hover {
    transform: scale(1.1) rotate(5deg);
    box-shadow: 0 8px 30px rgba(46, 204, 113, 0.6);
}

/* Chat styles */
.chat-terminal {
    height: 100%;
    display: flex;
    flex-direction: column;
    background: linear-gradient(180deg, rgba(26, 26, 26, 0.95), rgba(26, 26, 26, 0.98));
}

.terminal-header {
    background: var(--gradient-primary);
    padding: 1.2rem;
    color: var(--text-light);
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    font-size: 1.1rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.chat-messages {
    flex: 1;
    overflow-y: auto;
    padding: 1.2rem;
    color: var(--text-light);
    font-family: 'JetBrains Mono', 'Courier New', monospace;
    font-size: 14px;
    line-height: 1.6;
    scroll-behavior: smooth;
}

.chat-messages::-webkit-scrollbar {
    width: 8px;
}

.chat-messages::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 4px;
}

.chat-messages::-webkit-scrollbar-thumb {
    background: rgba(52, 152, 219, 0.5);
    border-radius: 4px;
}

.message {
    margin-bottom: 1.2rem;
    padding: 1rem;
    border-radius: 12px;
    display: flex;
    align-items: flex-start;
    gap: 1rem;
    background: rgba(255, 255, 255, 0.05);
    backdrop-filter: blur(5px);
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    transition: transform 0.2s ease;
}

.message:hover {
    transform: translateX(4px);
}

.message-avatar {
    width: 40px;
    height: 40px;
    background-image: url('/static/images/daisy_headshot.png');
    background-size: 120%;
    background-position: center;
    border-radius: 50%;
    flex-shrink: 0;
    transition: transform 0.3s ease;
}

.message-avatar:hover {
    transform: scale(1.1);
}

.daisy-message .message-avatar {
    border: 2px solid var(--secondary-color);
    box-shadow: 0 0 15px rgba(46, 204, 113, 0.4);
}

.user-message .message-avatar {
    background-color: var(--primary-color);
    border: 2px solid var(--primary-color);
    box-shadow: 0 0 15px rgba(52, 152, 219, 0.4);
}

.message-content {
    flex: 1;
    line-height: 1.7;
    font-size: 14px;
    font-family: 'JetBrains Mono', 'Courier New', monospace;
    white-space: pre-line;
    color: var(--text-light);
    opacity: 0.95;
}

.chat-input {
    display: flex;
    gap: 0.8rem;
    padding: 1rem;
    background: rgba(0, 0, 0, 0.3);
    border-top: 1px solid rgba(52, 152, 219, 0.2);
    backdrop-filter: blur(10px);
}

.chat-input input {
    flex: 1;
    background: rgba(255, 255, 255, 0.08);
    border: 1px solid rgba(52, 152, 219, 0.3);
    padding: 0.8rem 1rem;
    color: var(--text-light);
    font-family: 'JetBrains Mono', monospace;
    border-radius: 8px;
    font-size: 14px;
    transition: all 0.3s ease;
}

.chat-input input:focus {
    outline: none;
    border-color: var(--primary-color);
    background: rgba(255, 255, 255, 0.12);
    box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
}

.send-button {
    background: var(--gradient-accent);
    border: none;
    color: var(--text-dark);
    padding: 0.8rem 1.2rem;
    border-radius: 8px;
    font-family: 'Inter', sans-serif;
    font-size: 0.9rem;
    cursor: pointer;
    transition: all 0.3s ease;
    text-transform: uppercase;
    font-weight: 600;
    letter-spacing: 1px;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.send-button:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0, 191, 255, 0.4);
}

.send-button:active {
    transform: translateY(1px);
}

.typing-indicator {
    display: none;
    color: var(--primary-color);
    font-style: italic;
    margin: 0.8rem 1rem;
    font-family: 'JetBrains Mono', monospace;
    font-size: 14px;
    opacity: 0.8;
}

.typing-indicator.active {
    display: block;
    animation: pulse 1.5s infinite;
}

@keyframes pulse {
    0% { opacity: 0.4; }
    50% { opacity: 0.8; }
    100% { opacity: 0.4; }
}

/* Mobile Responsiveness */
@media (max-width: 768px) {
    .chat-popup {
        width: 100%;
        height: 100%;
        bottom: 0;
        right: 0;
        border-radius: 0;
    }
    
    .message {
        padding: 0.8rem;
    }
    
    .message-avatar {
        width: 35px;
        height: 35px;
    }
    
    .chat-input {
        padding: 0.8rem;
    }
}

/* Accessibility Improvements */
@media (prefers-reduced-motion: reduce) {
    * {
        animation: none !important;
        transition: none !important;
    }
}

/* High Contrast Mode */
@media (prefers-contrast: high) {
    :root {
        --primary-color: #0066cc;
        --secondary-color: #00994d;
    }
}

/* Chat Popup Styles */
.chat-popup {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 350px;
    height: 500px;
    background: rgba(0, 0, 0, 0.9);
    border: 2px solid #3498db;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(52, 152, 219, 0.3);
    display: none;
    z-index: 1000;
    overflow: hidden;
}

.chat-popup.active {
    display: block;
}

.chat-toggle {
    position: fixed;
    bottom: 90px;
    right: 20px;
    width: 60px;
    height: 60px;
    background: url('/static/images/daisy_headshot.png') center/cover;
    border: 2px solid #2ecc71;
    border-radius: 50%;
    cursor: pointer;
    box-shadow: 0 0 15px rgba(46, 204, 113, 0.3);
    z-index: 1001;
    transition: all 0.3s ease;
}

.chat-toggle:hover {
    transform: scale(1.1);
    box-shadow: 0 0 25px rgba(46, 204, 113, 0.5);
}

/* Chat styles */
.chat-terminal {
    height: 100%;
    display: flex;
    flex-direction: column;
}

.terminal-header {
    background: linear-gradient(45deg, #2c3e50, #2980b9);
    padding: 1rem;
    color: white;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    font-size: 1rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.chat-messages {
    flex: 1;
    overflow-y: auto;
    padding: 1rem;
    color: #fff;
    font-family: 'Courier New', monospace;
    font-size: 14px;
    line-height: 1.6;
}

.message {
    margin-bottom: 1rem;
    padding: 0.8rem;
    border-radius: 8px;
    display: flex;
    align-items: flex-start;
    gap: 0.8rem;
    background: rgba(0, 0, 0, 0.3);
}

.message-avatar {
    width: 35px;
    height: 35px;
    background-image: url('/static/images/daisy_headshot.png');
    background-size: 120%;
    background-position: center;
    border-radius: 50%;
    flex-shrink: 0;
}

.daisy-message .message-avatar {
    border: 2px solid #2ecc71;
    box-shadow: 0 0 10px rgba(46, 204, 113, 0.3);
}

.user-message .message-avatar {
    background-color: #3498db;
    border: 2px solid #3498db;
    box-shadow: 0 0 10px rgba(52, 152, 219, 0.3);
}

.user-message .message-avatar::after {
    content: '👤';
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100%;
    height: 100%;
    font-size: 16px;
}

.message-content {
    flex: 1;
    line-height: 1.6;
    font-size: 14px;
    font-family: 'Courier New', monospace;
    white-space: pre-line;
    color: #fff;
}

.chat-input {
    display: flex;
    gap: 0.5rem;
    padding: 0.8rem;
    background: rgba(0, 0, 0, 0.5);
    border-top: 1px solid rgba(52, 152, 219, 0.3);
}

.chat-input input {
    flex: 1;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(52, 152, 219, 0.5);
    padding: 0.5rem;
    color: white;
    font-family: monospace;
    border-radius: 5px;
    font-size: 14px;
}

.send-button {
    background: linear-gradient(45deg, #00ff88, #00bfff);
    border: none;
    color: black;
    padding: 0.5rem 1rem;
    border-radius: 5px;
    font-family: 'Orbitron', monospace;
    font-size: 0.8rem;
    cursor: pointer;
    transition: all 0.3s ease;
    text-transform: uppercase;
    font-weight: bold;
    letter-spacing: 1px;
}

.typing-indicator {
    display: none;
    color: #3498db;
    font-style: italic;
    margin: 0.5rem 1rem;
    font-family: 'Courier New', monospace;
    font-size: 14px;
}

.typing-indicator.active {
    display: block;
}

.info-button {
    background: linear-gradient(45deg, #2c3e50, #3498db);
    border: none;
    color: white;
    padding: 0.5rem 1rem;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 0.9rem;
}

.info-button:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
}

.score-info-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: 1000;
}

.score-info-modal.active {
    display: flex;
    justify-content: center;
    align-items: center;
}

.score-info-content {
    background: white;
    padding: 2rem;
    border-radius: 8px;
    max-width: 600px;
    width: 90%;
    position: relative;
    margin: 2rem auto;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.score-info-content p {
    color: #333 !important;
    font-size: 1rem !important;
    line-height: 1.6;
    margin-bottom: 1rem;
}

.score-info-content .lead {
    color: #333 !important;
    font-size: 1.1rem !important;
    line-height: 1.6;
    margin-bottom: 1.5rem;
}

.close-button {
    position: absolute;
    top: 1rem;
    right: 1rem;
    font-size: 1.5rem;
    color: #333;
    cursor: pointer;
    transition: color 0.3s ease;
}

.close-button:hover {
    color: #666;
}

.formula-box {
    background: #f8f9fa;
    border: 1px solid #dee2e6;
    border-radius: 8px;
    padding: 1.5rem;
    margin: 1.5rem 0;
}

.formula-box code {
    color: #333;
    font-size: 1.1rem;
}

.formula-box .small {
    color: #666;
    font-size: 0.9rem;
    margin-top: 0.5rem;
}

.intro-section {
    position: relative;
    padding: 4rem 0;
}

.intro-content {
    display: flex;
    gap: 4rem;
    margin-bottom: 4rem;
}

.intro-text {
    flex: 1;
}

.intro-image {
    flex: 1;
}

.intro-image img {
    width: 100%;
    height: 300px;
    object-fit: cover;
    border-radius: 8px;
}

.image-caption {
    position: absolute;
    bottom: 20px;
    left: 20px;
    right: 20px;
    background: rgba(0, 0, 0, 0.8);
    padding: 1rem;
    border-radius: 8px;
}

.image-caption p {
    color: white;
    margin: 0.5rem 0 0;
    font-size: 1.1rem;
    font-weight: 400;
}

.intro-features {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    margin-top: 2rem;
}

.feature {
    background: white;
    padding: 2rem;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    transition: transform 0.3s ease;
}

.feature h4 {
    color: #333;
    font-size: 1.25rem;
    margin-bottom: 1rem;
    font-weight: 600;
}

.feature p {
    color: #666;
    font-size: 1rem;
    line-height: 1.5;
    margin: 0;
}

.feature i {
    display: none;
}

.quote-section {
    margin-top: 3rem;
    padding: 2rem;
    background: rgba(255, 255, 255, 0.02);
    border-radius: 12px;
    border-left: 4px solid var(--primary-color);
}

.quote-text {
    font-size: 1.4rem !important;
    color: var(--text-color) !important;
    font-style: italic;
    line-height: 1.6;
    margin: 0;
}

/* Base font sizes */
.lead {
    font-size: 1.2rem !important;
    line-height: 1.6;
    color: var(--text-color) !important;
}

p {
    font-size: 1.2rem !important;
    line-height: 1.6;
    margin-bottom: 1.5rem;
    color: var(--text-color) !important;
}

.track-badge {
    display: inline-block;
    background: #333;
    color: white;
    padding: 0.5rem 1rem;
    border-radius: 4px;
    font-size: 0.9rem;
    font-weight: 500;
    margin-bottom: 1.5rem;
}

.text-muted {
    font-size: 1.1rem !important;
    color: rgba(0, 0, 0, 0.7) !important;
}

.daisy-form .form-label {
    color: var(--text-color) !important;
    font-size: 1.2rem !important;
    font-weight: 500;
}

.daisy-form small {
    font-size: 1.1rem !important;
    color: rgba(0, 0, 0, 0.7) !important;
}

.daisy-score-container {
    position: relative;
    width: 200px;
    height: 200px;
    margin: 0 auto 2rem;
    background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 0 30px rgba(var(--primary-rgb), 0.3);
}

.daisy-score {
    text-align: center;
    color: white;
}

.daisy-score span {
    font-size: 3rem;
    font-weight: bold;
    display: block;
}

.daisy-chart {
    max-width: 400px;
    margin: 0 auto;
}

.interpretation {
    max-width: 400px;
    margin: 0 auto;
}

.daisy-components {
    background: rgba(0, 0, 0, 0.1);
    border-radius: 10px;
    padding: 1rem;
}

.score-ranges {
    text-align: left;
    background: rgba(0, 0, 0, 0.1);
    border-radius: 10px;
    padding: 1.5rem;
}

.range-item {
    font-size: 1.2rem !important;
    color: var(--text-color) !important;
    margin-bottom: 1rem;
}

.daisy-image-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
    max-width: 900px;
    margin: 0 auto;
}

.daisy-image {
    width: 100%;
    height: 200px;
    object-fit: cover;
    border-radius: 8px;
    transition: transform 0.3s ease;
}

.daisy-image:hover {
    transform: scale(1.05);
}

.daisy-showcase {
    background: rgba(255, 255, 255, 0.03);
    border-radius: 12px;
    padding: 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.1);
    margin-top: 2rem;
}

.daisy-showcase img {
    width: 100%;
    height: 400px;
    object-fit: cover;
    border-radius: 8px;
    margin-bottom: 1rem;
}

.daisy-showcase .track-badge {
    display: inline-block;
    margin-bottom: 0.5rem;
}

.daisy-showcase p {
    color: rgba(255, 255, 255, 0.7);
    margin: 0;
}

.neural-network-text {
    color: rgba(255, 255, 255, 0.9);
    text-shadow: 0 0 10px rgba(52, 152, 219, 0.5);
}

.features-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 2rem;
    margin: 3rem 0;
}

.feature-item {
    background: rgba(255, 255, 255, 0.03);
    padding: 2rem;
    border-radius: 12px;
    text-align: center;
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.feature-item:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(52, 152, 219, 0.1);
}

.feature-item i {
    font-size: 2.5rem;
    color: #3498db;
    margin-bottom: 1rem;
    display: block;
}

.feature-item h4 {
    color: white;
    font-size: 1.25rem;
    margin-bottom: 0.75rem;
    font-weight: 600;
}

.feature-item p {
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.95rem;
    line-height: 1.5;
    margin: 0;
}

.coach-quote {
    font-style: italic;
    color: #fff;
    border-left: 3px solid #3498db;
    padding: 1.5rem 2rem;
    margin: 2rem 0;
    background: rgba(52, 152, 219, 0.05);
    border-radius: 0 12px 12px 0;
    font-size: 1.1rem;
    line-height: 1.6;
}

.preview-card {
    background: rgba(255, 255, 255, 0.05);
    padding: 1.5rem;
    border-radius: 12px;
    margin-bottom: 1rem;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.preview-card .workout-type {
    display: inline-block;
    padding: 0.3rem 0.8rem;
    background: rgba(52, 152, 219, 0.2);
    border-radius: 4px;
    font-size: 0.8rem;
    margin-bottom: 0.5rem;
}

.preview-card h4 {
    color: white;
    margin-bottom: 0.5rem;
}

.preview-card p {
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.9rem;
    margin: 0;
}

.features-text {
    background: white;
    padding: 2rem;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.features-text p {
    color: #333;
    font-size: 1.1rem;
    line-height: 1.6;
    margin-bottom: 1.5rem;
}

.features-text p:last-child {
    margin-bottom: 0;
}

.features-text strong {
    color: #000;
    font-weight: 600;
}

.quote-section {
    background: #f8f9fa;
    border-left: 4px solid #3498db;
    padding: 1.5rem 2rem;
    margin: 2rem 0;
    border-radius: 0 8px 8px 0;
}

.quote-section p {
    color: #333;
    font-size: 1.1rem;
    font-style: italic;
    line-height: 1.6;
    margin: 0;
}

.intro-text h2 {
    color: #333;
    font-size: 2rem;
    font-weight: 600;
    margin-bottom: 1.5rem;
}

.intro-text .lead {
    color: #666;
    font-size: 1.2rem;
    line-height: 1.6;
    margin-bottom: 2rem;
}

.white-container {
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    padding: 2rem;
}

.white-container h2 {
    color: #333;
    font-size: 2rem;
    font-weight: 600;
    margin-bottom: 1.5rem;
}

.white-container .lead {
    color: #666;
    font-size: 1.2rem;
    line-height: 1.6;
    margin-bottom: 1.5rem;
}

.white-container p {
    color: #666;
    font-size: 1.1rem;
    line-height: 1.6;
    margin-bottom: 1.5rem;
}

.quote-section {
    background: #f8f9fa;
    border-left: 4px solid #3498db;
    padding: 1.5rem 2rem;
    margin: 2rem 0;
    border-radius: 0 8px 8px 0;
}

.quote-section p {
    color: #333;
    font-size: 1.1rem;
    font-style: italic;
    line-height: 1.6;
    margin: 0;
}

.brand-heading {
    font-size: 3rem;
    font-weight: 700;
    margin-bottom: 1rem;
}

.brand-heading .normal {
    color: #333;
}

.brand-heading .highlight {
    color: #3498db;
}

.subheading {
    color: #666;
    font-size: 1.5rem;
    margin-bottom: 2rem;
}

.track-badge {
    display: inline-block;
    background: #3498db;
    color: white;
    padding: 0.5rem 1rem;
    border-radius: 4px;
    font-size: 0.9rem;
    font-weight: 500;
    margin-bottom: 1.5rem;
}

.pulse-badge {
    animation: pulse 2s infinite;
}

@keyframes pulse {
    0% {
        box-shadow: 0 0 0 0 rgba(52, 152, 219, 0.4);
    }
    70% {
        box-shadow: 0 0 0 10px rgba(52, 152, 219, 0);
    }
    100% {
        box-shadow: 0 0 0 0 rgba(52, 152, 219, 0);
    }
}

.intro-content {
    display: flex;
    gap: 4rem;
    margin-bottom: 4rem;
}

.intro-text {
    flex: 1;
}

.intro-image {
    flex: 1;
}

@media (max-width: 768px) {
    .intro-content {
        flex-direction: column;
        gap: 2rem;
    }
    
    .intro-image img {
        height: 200px;
    }
}

/* Update Meet DAISY section layout */
.meet-daisy-content {
    position: relative;
    overflow: hidden;
    padding: 1rem;
}

.meet-daisy-image {
    float: right;
    width: 180px;
    margin: 0 0 1rem 2rem;
}

.meet-daisy-image img {
    width: 100%;
    height: auto;
    border-radius: 50%;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

.meet-daisy-text {
    overflow: hidden;
}

.track-badge {
    display: inline-block;
    background: #333 !important;
    color: white !important;
    padding: 0.5rem 1rem;
    border-radius: 4px;
    font-size: 0.9rem;
    font-weight: 500;
    margin-bottom: 1.5rem;
}

/* Chat Interface Styles */
.chat-interface {
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    padding: 2rem;
    margin-top: 2rem;
}

.chat-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1.5rem;
}

.chat-header img {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid var(--primary-color);
}

.chat-header h3 {
    margin: 0;
    color: var(--primary-color);
    font-size: 1.5rem;
}

.chat-messages {
    height: 400px;
    overflow-y: auto;
    padding: 1rem;
    background: #f8f9fa;
    border-radius: 8px;
    margin-bottom: 1rem;
}

.message {
    margin-bottom: 1rem;
    display: flex;
    gap: 1rem;
}

.message-content {
    padding: 0.8rem 1.2rem;
    border-radius: 12px;
    max-width: 80%;
}

.user-message {
    justify-content: flex-end;
}

.user-message .message-content {
    background: var(--primary-color);
    color: white;
    border-radius: 12px 12px 0 12px;
}

.daisy-message .message-content {
    background: #e9ecef;
    color: #333;
    border-radius: 12px 12px 12px 0;
}

.chat-input {
    display: flex;
    gap: 1rem;
}

.chat-input input {
    flex: 1;
    padding: 0.8rem;
    border: 1px solid #dee2e6;
    border-radius: 8px;
    font-size: 1rem;
}

.chat-input button {
    padding: 0.8rem 1.5rem;
    background: var(--primary-color);
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.chat-input button:hover {
    background: var(--secondary-color);
    transform: translateY(-2px);
}

.suggested-questions {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-bottom: 1rem;
}

.question-btn {
    padding: 0.5rem 1rem;
    background: #e9ecef;
    border: none;
    border-radius: 20px;
    cursor: pointer;
    font-size: 0.9rem;
    transition: all 0.3s ease;
}

.question-btn:hover {
    background: var(--primary-color);
    color: white;
}

@media (max-width: 768px) {
    .chat-messages {
        height: 300px;
    }
    
    .message-content {
        max-width: 90%;
    }
    
    .chat-input {
        flex-direction: column;
    }
    
    .chat-input button {
        width: 100%;
    }
}
</style>
{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="row">
        <div class="col-12 text-center mb-5">
            <h1 class="brand-heading">
                <span class="normal">D</span><span class="highlight">AI</span><span class="normal">SY</span>™
            </h1>
            <p class="subheading mb-4">Data Activated Individualized System for You</p>
    
        </div>
    </div>

    <!-- DAISY Coach Introduction -->
    <div class="row mb-5">
        <div class="col-12">
            <div class="white-container">
                <div class="track-badge">The Future of Training</div>
                <div class="meet-daisy-content">
                    <div class="meet-daisy-image">
                        <img src="{{ url_for('static', filename='images/daisy_headshot.png') }}" 
                             alt="DAISY" 
                             class="img-fluid rounded">
                    </div>
                    <div>
                        <h2 class="mb-4">Meet DAISY™</h2>
                        <p class="lead">DAISY™ combines the wisdom of a 140-year-old horse with cutting-edge AI to deliver personalized running guidance. From the pristine trails of Yellowstone to the legendary Wingate track, DAISY's hooves have covered every terrain imaginable.</p>
                        
                        <p>With 140 years of wisdom enhanced by quantum AI, DAISY brings unparalleled experience to your training. Our advanced neural networks have processed centuries of equine knowledge, transforming it into actionable insights for modern runners.</p>
                        
                        <p>Through 320 handcrafted sessions from Wingate's finest, each workout is meticulously designed to push your limits and expand your potential. These sessions represent the culmination of DAISY's extensive experience across diverse terrains and conditions.</p>

                        <p>The revolutionary DAISY™ Score measures your personal harmony with the track, providing insights that go beyond traditional analytics. This proprietary metric helps you understand your running in ways that conventional statistics simply cannot capture.</p>

                        <blockquote class="quote-section">
                            <p>"In my 140 years galloping across this earth, I've learned that the best runners think like horses - wild and free, yet disciplined in their pursuit of excellence."</p>
                        </blockquote>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Chat Interface -->
    <div class="row mb-5">
        <div class="col-12">
            <div class="chat-interface">
                <div class="chat-header">
                    <img src="{{ url_for('static', filename='images/daisy_headshot.png') }}" alt="DAISY">
                    <h3>Chat with DAISY™</h3>
                </div>
                
                <div class="chat-messages" id="chatMessages">
                    <div class="message daisy-message">
                        <div class="message-content">
                            Hello! I'm DAISY™, your 140-year-old equine running coach. How can I help you today?
                        </div>
                    </div>
                </div>

                <div class="suggested-questions">
                    <button class="question-btn" onclick="askSuggestedQuestion(this)">How should I run a 320?</button>
                    <button class="question-btn" onclick="askSuggestedQuestion(this)">What is your recommendation for my five-year galloping plan?</button>
                    <button class="question-btn" onclick="askSuggestedQuestion(this)">Does mane aerodynamics really affect performance?</button>
                </div>

                <div class="chat-input">
                    <input type="text" id="messageInput" placeholder="Type your message..." onkeypress="handleKeyPress(event)">
                    <button onclick="sendMessage()">Send</button>
                </div>
            </div>
        </div>
    </div>

    <!-- DAISY Score Section -->
    <div class="row mb-5">
        <div class="col-12">
            <div class="white-container">
                <div class="track-badge pulse-badge">PROPRIETARY METRICS</div>
                <h2 class="mb-4">The DAISY™ Score</h2>
                <p class="lead">Combining equine intuition with quantum computing, your DAISY™ score measures your harmony with the natural rhythms of running.</p>
                
                <button class="info-button mb-4" onclick="toggleScoreInfo()">
                    <i class="fas fa-info-circle"></i> How is DAISY™ Score calculated?
                </button>

                <!-- Score Info Modal -->
                <div id="scoreInfoModal" class="score-info-modal">
                    <div class="score-info-content">
                        <span class="close-button" onclick="toggleScoreInfo()">&times;</span>
                        <h3 class="mb-3">DAISY™ Score Calculation</h3>
                        <p class="lead">Our proprietary DAISY™ metric revolutionizes performance tracking by quantifying the unquantifiable: your unique running signature.</p>
                        
                        <div class="technical-specs mt-4">
                            <p>Your DAISY™ score is computed using our patented formula:</p>
                            <div class="formula-box p-3 mb-4 text-center">
                                <code>D = Σ(ν∆t × φ) + λ(ρ - μ)² × ψ</code>
                                <p class="small text-muted mt-2">Where ν = velocity variations, φ = flow state coefficient, λ = latent optimization factor</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Calculator Form -->
                <div class="calculator-section mt-4">
                    <div class="row">
                        <div class="col-md-6">
                            <form id="daisyCalculator" class="daisy-form">
                                <div class="mb-4">
                                    <label class="form-label">Resting Heart Rate</label>
                                    <input type="range" class="form-control" id="heartRate" min="20" max="100" value="60">
                                    <div class="d-flex justify-content-between">
                                        <small>Low</small>
                                        <small class="value-display">60</small>
                                        <small>High</small>
                                    </div>
                                </div>

                                <div class="mb-4">
                                    <label class="form-label">Shoe Size</label>
                                    <input type="number" class="form-control" id="shoeSize" placeholder="Enter shoe size" min="1" max="99">
                                    <small class="text-muted">The odder the shoe, the better the DAISY</small>
                                </div>

                                <div class="mb-4">
                                    <label class="form-label">Number of Running Shoes Owned</label>
                                    <input type="number" class="form-control" id="shoeCount" placeholder="Enter number" min="0" max="999">
                                </div>

                                <div class="mb-4">
                                    <label class="form-label">Astrological Sign</label>
                                    <select class="form-select" id="astroSign">
                                        <option value="">Select your sign</option>
                                        <option value="1">Aries</option>
                                        <option value="2">Taurus</option>
                                        <option value="3">Gemini</option>
                                        <option value="4">Cancer</option>
                                        <option value="5">Leo</option>
                                        <option value="6">Virgo</option>
                                        <option value="7">Libra</option>
                                        <option value="8">Scorpio</option>
                                        <option value="9">Sagittarius</option>
                                        <option value="10">Capricorn</option>
                                        <option value="11">Aquarius</option>
                                        <option value="12">Pisces</option>
                                    </select>
                                </div>

                                <div class="mb-4">
                                    <label class="form-label">Preferred Christina Aguilera Song</label>
                                    <select class="form-select" id="soundtrack">
                                        <option value="">Select a song</option>
                                        <option value="1">Genie in a Bottle</option>
                                        <option value="2">Fighter</option>
                                        <option value="3">Beautiful</option>
                                        <option value="4">Dirrty</option>
                                        <option value="5">What a Girl Wants</option>
                                        <option value="6">Ain't No Other Man</option>
                                        <option value="7">Lady Marmalade</option>
                                        <option value="8">Candyman</option>
                                        <option value="9">Hurt</option>
                                        <option value="10">Come On Over Baby</option>
                                    </select>
                                </div>

                                <div class="mb-4">
                                    <label class="form-label">Favorite Ice Cream Brand</label>
                                    <select class="form-select" id="iceCream">
                                        <option value="">Select a brand</option>
                                        <option value="1">Ben & Jerry's</option>
                                        <option value="2">Häagen-Dazs</option>
                                        <option value="3">Van Leeuwen</option>
                                        <option value="4">Turkey Hill</option>
                                        <option value="5">Milk Bar</option>
                                        <option value="6">Ample Hills</option>
                                        <option value="7">Blue Marble</option>
                                        <option value="8">Talenti</option>
                                        <option value="9">Lincoln Market Giant Neopolitan</option>
                                    </select>
                                </div>

                                <button type="submit" class="btn btn-primary w-100 hover-lift">Calculate DAISY™ Score</button>
                            </form>
                        </div>
                        <div class="col-md-6">
                            <div id="daisyResult" class="text-center" style="display: none;">
                                <div class="daisy-score-container">
                                    <div class="daisy-score">
                                        <span id="daisyScoreValue">0</span>
                                        <small>DAISY™</small>
                                    </div>
                                </div>

                                <div class="daisy-chart">
                                    <canvas id="daisyRadarChart"></canvas>
                                </div>

                                <div class="interpretation mt-4">
                                    <div class="track-badge mb-3">QUANTUM INTERPRETATION</div>
                                    <p id="daisyInterpretation" class="lead"></p>
                                </div>

                                <div class="score-ranges mt-4">
                                    <div class="track-badge mb-3">DAISY™ SCORE RANGES</div>
                                    <div class="range-item mb-2">
                                        <span>0-320:</span> "The Conformist" - Your running is dangerously predictable. Daisy would not approve.
                                    </div>
                                    <div class="range-item mb-2">
                                        <span>321-640:</span> "The Awakened" - Beginning to embrace chaos. Your runs show promising signs of unpredictability.
                                    </div>
                                    <div class="range-item mb-2">
                                        <span>641-800:</span> "The Enlightened" - Advanced chaos mastery. Your running patterns beautifully confuse our AI.
                                    </div>
                                    <div class="range-item mb-2">
                                        <span>801-959:</span> "The Transcendent" - Near perfect entropy. You've achieved what we call "controlled chaos."
                                    </div>
                                    <div class="range-item">
                                        <span>960+:</span> "The Daisy" - Pure quantum running state. You exist simultaneously at all points on the track.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Chat Popup -->
<button class="chat-toggle" onclick="toggleChat()">
</button>

<div class="chat-popup" id="chatPopup">
    <div class="chat-terminal">
        <div class="terminal-header">
            <span>Chat with DAISY™</span>
            <span class="close-button" onclick="toggleChat()">&times;</span>
        </div>
        <div class="chat-messages" id="chatMessages">
            <div class="message daisy-message">
                <div class="message-avatar"></div>
                <div class="message-content">
                    Hello! I'm DAISY™, your 140-year-old equine running coach. How can I help you today?
                </div>
            </div>
        </div>
        <!-- Suggested Questions -->
        <div class="suggested-questions">
            <button class="question-btn" onclick="askSuggestedQuestion(this)">How should I run a 320?</button>
            <button class="question-btn" onclick="askSuggestedQuestion(this)">What is your recommendation for my five-year galloping plan?</button>
            <button class="question-btn" onclick="askSuggestedQuestion(this)">Does mane aerodynamics really affect performance?</button>
        </div>
        <div class="chat-input">
            <input type="text" id="messageInput" placeholder="Type your message..." onkeypress="handleKeyPress(event)">
            <button class="send-button" onclick="sendMessage()">Send</button>
        </div>
    </div>
</div>

<!-- Add Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- Chat and Calculator Scripts -->
<script>
// Score info modal functionality
function toggleScoreInfo() {
    const modal = document.getElementById('scoreInfoModal');
    modal.classList.toggle('active');
}

// DAISY Score Calculator functionality
document.getElementById('daisyCalculator').addEventListener('submit', function(e) {
    e.preventDefault(); // Prevent form submission

    // Get form values
    const heartRate = parseInt(document.getElementById('heartRate').value);
    const shoeSize = parseInt(document.getElementById('shoeSize').value);
    const shoeCount = parseInt(document.getElementById('shoeCount').value);
    const astroSign = parseInt(document.getElementById('astroSign').value);
    const soundtrack = parseInt(document.getElementById('soundtrack').value);
    const iceCream = parseInt(document.getElementById('iceCream').value);

    // Calculate DAISY score (example calculation)
    const baseScore = 320;
    const heartRateMultiplier = (100 - heartRate) / 100;
    const shoeFactor = (shoeSize % 2 === 0) ? 0.8 : 1.2;
    const shoeMultiplier = Math.min(shoeCount / 10, 1);
    const astroMultiplier = (astroSign / 12) + 0.5;
    const soundtrackBonus = soundtrack * 10;
    const iceCreamBonus = iceCream * 15;

    const score = Math.round(
        baseScore * heartRateMultiplier * shoeFactor * shoeMultiplier * astroMultiplier +
        soundtrackBonus + iceCreamBonus
    );

    // Update score display
    document.getElementById('daisyScoreValue').textContent = score;
    document.getElementById('daisyResult').style.display = 'block';

    // Create radar chart data
    const ctx = document.getElementById('daisyRadarChart').getContext('2d');
    new Chart(ctx, {
        type: 'radar',
        data: {
            labels: ['Heart Rate', 'Shoe Factor', 'Collection', 'Astrology', 'Music', 'Taste'],
            datasets: [{
                label: 'Your DAISY™ Profile',
                data: [
                    heartRateMultiplier * 100,
                    shoeFactor * 100,
                    shoeMultiplier * 100,
                    astroMultiplier * 100,
                    (soundtrack / 10) * 100,
                    (iceCream / 9) * 100
                ],
                backgroundColor: 'rgba(52, 152, 219, 0.2)',
                borderColor: 'rgba(52, 152, 219, 1)',
                pointBackgroundColor: 'rgba(52, 152, 219, 1)',
                pointBorderColor: '#fff',
                pointHoverBackgroundColor: '#fff',
                pointHoverBorderColor: 'rgba(52, 152, 219, 1)'
            }]
        },
        options: {
            scales: {
                r: {
                    angleLines: {
                        display: true
                    },
                    suggestedMin: 0,
                    suggestedMax: 100
                }
            }
        }
    });

    // Update interpretation
    let interpretation = '';
    if (score <= 320) {
        interpretation = 'Your running style needs more chaos. Try running backwards occasionally.';
    } else if (score <= 640) {
        interpretation = 'You\'re beginning to think like a horse. Keep exploring unconventional paths.';
    } else if (score <= 800) {
        interpretation = 'Your quantum running potential is emerging. The track fears you.';
    } else if (score <= 959) {
        interpretation = 'You\'ve achieved near-perfect entropy. DAISY approves.';
    } else {
        interpretation = 'Pure quantum running state achieved. You are one with the track.';
    }
    document.getElementById('daisyInterpretation').textContent = interpretation;
});

// Update heart rate display
document.getElementById('heartRate').addEventListener('input', function(e) {
    document.querySelector('.value-display').textContent = e.target.value;
});

// Chat functionality
function toggleChat() {
    const popup = document.getElementById('chatPopup');
    popup.classList.toggle('active');
    if (popup.classList.contains('active')) {
        document.getElementById('messageInput').focus();
    }
}

function handleKeyPress(event) {
    if (event.key === 'Enter') {
        sendMessage();
    }
}

function sendMessage() {
    const input = document.getElementById('messageInput');
    const message = input.value.trim();
    if (!message) return;

    // Add user message
    addMessage('user', message);
    input.value = '';

    // Show typing indicator
    showTypingIndicator();

    // Call the API endpoint
    fetch('/api/chat', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({
            message: message,
            persona: 'classic'  // Using classic mode by default
        })
    })
    .then(response => response.json())
    .then(data => {
        hideTypingIndicator();
        if (data.error) {
            addMessage('daisy', 'Sorry, I encountered an error. Please try again.');
            console.error('Error:', data.error);
        } else {
            addMessage('daisy', data.response);
        }
    })
    .catch(error => {
        hideTypingIndicator();
        addMessage('daisy', 'Sorry, I encountered an error. Please try again.');
        console.error('Error:', error);
    });
}

function addMessage(type, content) {
    const messages = document.getElementById('chatMessages');
    const messageDiv = document.createElement('div');
    messageDiv.className = `message ${type}-message`;
    messageDiv.innerHTML = `
        <div class="message-avatar"></div>
        <div class="message-content">${content}</div>
    `;
    messages.appendChild(messageDiv);
    messages.scrollTop = messages.scrollHeight;
}

function showTypingIndicator() {
    const messages = document.getElementById('chatMessages');
    const indicator = document.createElement('div');
    indicator.className = 'typing-indicator';
    indicator.textContent = 'DAISY is thinking...';
    messages.appendChild(indicator);
    messages.scrollTop = messages.scrollHeight;
}

function hideTypingIndicator() {
    const indicator = document.querySelector('.typing-indicator');
    if (indicator) {
        indicator.remove();
    }
}

// Array of rotating topics
const dailyTopics = [
    "New studies suggest oat-fueled endurance is 14% more effective than traditional carb-loading.",
    "Today's optimal hoof cadence is 179.3 strides per minute. Ask me how to adjust yours.",
    "Negative splits improve by 8.2% after consuming ice cream—if you believe hard enough.",
    "Research shows galloping in zigzags increases endurance by 23.7%.",
    "Breaking news: Backward running while thinking about hay improves form by 15.9%.",
    "Today's quantum alignment suggests a 12.4% boost in performance when running clockwise.",
    "Studies indicate that horse-inspired breathing techniques enhance VO2 max by 18.3%.",
    "New data: Running with your mane flowing in the wind reduces drag by 7.2%."
];

// Function to set a random topic
function setRandomTopic() {
    const topicContent = document.getElementById('topicContent');
    const randomIndex = Math.floor(Math.random() * dailyTopics.length);
    topicContent.textContent = dailyTopics[randomIndex];
}

// Function to handle suggested question clicks
function askSuggestedQuestion(button) {
    const input = document.getElementById('messageInput');
    input.value = button.textContent;
    sendMessage();
}

// Initialize when page loads
document.addEventListener('DOMContentLoaded', function() {
    // Focus input when chat is opened
    document.querySelector('.chat-toggle').addEventListener('click', function() {
        setTimeout(() => {
            document.getElementById('messageInput').focus();
        }, 100);
    });
});
</script>
{% endblock %} 